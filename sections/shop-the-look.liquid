{% schema %}
{
  "name": "Shop the Look",
  "tag": "section",
  "class": "shop-the-look-section",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Get The Look"
    },
    {
      "type": "text",
      "id": "style_badge",
      "label": "Style Badge",
      "default": "STYLE 1"
    },
    {
      "type": "image_picker",
      "id": "look_image",
      "label": "Main Image"
    }
  ],
  "blocks": [
    {
      "type": "product_slide",
      "name": "Product Slide",
      "settings": [
        {
          "type": "product",
          "id": "product",
          "label": "Product"
        }
      ]
    }
  ],
  "max_blocks": 8,
  "presets": [
    {
      "name": "Shop the Look Example",
      "category": "Image",
      "blocks": [
        { "type": "product_slide" },
        { "type": "product_slide" }
      ]
    }
  ]
}
{% endschema %}

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

<section class="shop-the-look-matched-border">
  <div class="shop-the-look-flexbox">
    <!-- LEFT IMAGE -->
    <div class="shop-the-look-left-img">
      {% if section.settings.look_image != blank %}
        <img src="{{ section.settings.look_image | img_url: '800x' }}" alt="Shop the Look image" style="width:100%;height:auto;" />
      {% endif %}
    </div>

    <!-- RIGHT CAROUSEL + HEADER -->
    <div class="shop-the-look-right">
      <div class="stl-header-wrap">
        {% if section.settings.style_badge != blank %}
          <span class="stl-badge">{{ section.settings.style_badge }}</span>
        {% endif %}
        {% if section.settings.heading != blank %}
          <h2 class="stl-title">{{ section.settings.heading }}</h2>
        {% endif %}
      </div>
      <div class="swiper shop-the-look-swiper">
        <div class="swiper-wrapper">
          {% for block in section.blocks %}
            {% assign p = block.settings.product %}
            {% if p != blank %}
              <div class="swiper-slide">
                <div class="stl-slider-img-wrap">
                  <img src="{{ p.featured_image | img_url: '400x' }}"/>
                </div>
                <div class="stl-product-info">
                  <div class="stl-product-title">{{ p.title }}</div>
                  <div class="stl-product-price">{{ p.price | money }}</div>
                </div>
              </div>
            {% endif %}
          {% endfor %}
        </div>
        <div class="swiper-button-prev"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-pagination"></div>
      </div>
    </div>
  </div>
</section>

<style>
.shop-the-look-matched-border {
  border: 3px solid #222;
  border-radius: 22px;
  background: #fff;
  max-width: 1000px;
  margin: 40px auto;
  padding: 18px 38px 28px 38px;
  box-sizing: border-box;
  box-shadow: 0 6px 38px 0 rgba(163,114,152,.10);
}
.shop-the-look-flexbox {
  display: flex;
  align-items: center;
  gap: 32px;
}
.shop-the-look-left-img {
  flex: 1 1 52%;
  max-width: 440px;
}
.shop-the-look-left-img img {
  width: 100%;
  border-radius: 2px;
}
.shop-the-look-right {
  flex: 1 1 46%;
  min-width: 350px;
  display: flex;
  flex-direction: column;
  align-items: center;
}
.stl-header-wrap {
  position: relative;
  text-align: center;
  margin-bottom: 16px;
  width: 100%;
}
.stl-badge {
  position: absolute;
  top: -30px;
  right: 0;
  background: #222;
  color: #fff;
  border-radius: 7px;
  font-size: 20px;
  font-weight: 600;
  padding: 2px 22px;
  letter-spacing: 2px;
  z-index: 10;
}
.stl-title {
  font-size: 24px;
  margin: 0 0 12px 0;
  font-weight: bold;
  text-align: center;
}
.shop-the-look-swiper {
  width: 100%;
  max-width: 320px;
}
.swiper-slide {
  display: flex;
  flex-direction: column;
  align-items: center;
}
.stl-slider-img-wrap {
  width: 220px;
  height: 280px;
  background: #f4f0ee;
  border-radius: 4px;
  overflow: hidden;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: 12px;
}
.stl-slider-img-wrap img {
  width: 100%;
  max-height: 100%;
  object-fit: contain;
}
.stl-product-title {
  font-size: 16px;
  font-weight: 500;
  text-align: center;
  margin-bottom: 4px;
}
.stl-product-price {
  color: #222;
  font-size: 17px;
  font-weight: 600;
  text-align: center;
}
.swiper-button-next, .swiper-button-prev {
  color: #333;
}
.swiper-pagination {
  margin-top: 8px;
}
.shop-the-look-matched-border {
  background: linear-gradient(120deg, #ffe2eb 0%, #fff7fa 100%);
}

@media (max-width: 900px) {
  .shop-the-look-flexbox {
    flex-direction: column;
    gap: 16px;
  }
  .shop-the-look-left-img, .shop-the-look-right {
    max-width: 100%;
    width: 100%;
    flex: none;
  }
  .stl-header-wrap {
    margin-top: 14px;
  }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function () {
  if (window.Swiper) {
    new Swiper('.shop-the-look-swiper', {
      slidesPerView: 1,
      navigation: {
        nextEl: '.swiper-button-next',
        prevEl: '.swiper-button-prev',
      },
      pagination: {
        el: '.swiper-pagination',
        clickable: true,
      },
      loop: true,
    });
  }
});
</script>
